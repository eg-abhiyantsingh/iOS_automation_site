<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE suite SYSTEM "https://testng.org/testng-1.0.dtd">
<suite name="Verify Fixes - All Previously Failing Tests" parallel="false" verbose="0">

    <!-- Custom Listener for Clean Console Output -->
    <listeners>
        <listener class-name="com.egalvanic.listeners.ConsoleProgressListener"/>
    </listeners>

    <!--
    ============================================================
    ALL PREVIOUSLY FAILING TESTS (193 total)
    ============================================================

    RUN COMMAND:
    cd /Users/abhiyantsingh/Downloads/iOS_automation_site
    mvn test -DsuiteXmlFile=src/test/resources/verify-fixes-all-failures.xml

    ROOT CAUSES FIXED:
    1. Issues Phase 1 cascade (55 tests) — login recovery in ensureOnIssuesScreen()
    2. Asset Phase 5 (97 tests) — loginAndSelectSite() screen detection fix
    3. Issues Phase 2 (17 tests) — Thermal Anomaly class change + timeouts
    4. Issues Phase 3 (12 tests) — sort O(N log N) fix + badge case-insensitive + swipe
    5. Connections (7 tests) — arrow format + cancel button + misc
    6. Location (4 tests) — context menu dismiss + known app bugs (skipped)
    7. Site (1 test) — dashboard detection timing
    ============================================================
    -->

    <!-- ======================================== -->
    <!-- 1. ISSUES PHASE 1 — Cascade failures (55 tests) -->
    <!--    Root cause: login session lost, no recovery -->
    <!--    Fix: ensureOnIssuesScreen() login recovery -->
    <!-- ======================================== -->
    <test name="1. Issues Phase 1 - Cascade Fixes (55 tests)">
        <classes>
            <class name="com.egalvanic.tests.Issue_Phase1_Test">
                <methods>
                    <include name="TC_ISS_045_verifySelectingAsset"/>
                    <include name="TC_ISS_046_verifyAddAssetButton"/>
                    <include name="TC_ISS_047_verifyQRScanButton"/>
                    <include name="TC_ISS_048_verifyCreateIssueEnabledAfterRequiredFields"/>
                    <include name="TC_ISS_049_verifyIssueCreatedSuccessfully"/>
                    <include name="TC_ISS_050_verifyNewIssueAppearsInList"/>
                    <include name="TC_ISS_051_verifyIssueCountIncreases"/>
                    <include name="TC_ISS_052_verifyTappingIssueOpensDetails"/>
                    <include name="TC_ISS_053_verifyIssueDetailsHeader"/>
                    <include name="TC_ISS_054_verifyStatusDropdown"/>
                    <include name="TC_ISS_055_verifyChangingStatusToInProgress"/>
                    <include name="TC_ISS_056_verifyChangingStatusToResolved"/>
                    <include name="TC_ISS_057_verifyChangingStatusToClosed"/>
                    <include name="TC_ISS_058_verifyPriorityOnDetails"/>
                    <include name="TC_ISS_059_verifyIssueClassOnDetails"/>
                    <include name="TC_ISS_060_verifyIssueDetailsSectionCompletion"/>
                    <include name="TC_ISS_061_verifyRequiredFieldsToggle"/>
                    <include name="TC_ISS_062_verifySubcategoryFieldForNEC"/>
                    <include name="TC_ISS_063_verifySubcategoryDropdownOptions"/>
                    <include name="TC_ISS_064_verifySelectingNECSubcategory"/>
                    <include name="TC_ISS_065_verifyAllNECSubcategoryOptions"/>
                    <include name="TC_ISS_066_verifySubcategorySearchable"/>
                    <include name="TC_ISS_067_verifyDescriptionField"/>
                    <include name="TC_ISS_068_verifyEnteringDescription"/>
                    <include name="TC_ISS_069_verifyProposedResolutionField"/>
                    <include name="TC_ISS_070_verifyEnteringResolution"/>
                    <include name="TC_ISS_071_verifyIssuePhotosSection"/>
                    <include name="TC_ISS_072_verifyGalleryButton"/>
                    <include name="TC_ISS_073_verifyCameraButton"/>
                    <include name="TC_ISS_074_verifyDeleteIssueButton"/>
                    <include name="TC_ISS_075_verifyDeleteConfirmation"/>
                    <include name="TC_ISS_076_verifyConfirmDeleteRemovesIssue"/>
                    <include name="TC_ISS_077_verifySaveChangesButton"/>
                    <include name="TC_ISS_078_verifySavingChanges"/>
                    <include name="TC_ISS_079_verifyUnsavedChangesWarning"/>
                    <include name="TC_ISS_080_verifyDoneButtonReturnsToPreviousScreen"/>
                    <include name="TC_ISS_081_verifyCloseButtonOnIssueDetails"/>
                    <include name="TC_ISS_082_verifyOSHAViolationSubcategories"/>
                    <include name="TC_ISS_083_verifyThermalAnomalySubcategories"/>
                    <include name="TC_ISS_084_verifyCreatingIssueWithoutOptionalFields"/>
                    <include name="TC_ISS_085_verifyVeryLongDescription"/>
                    <include name="TC_ISS_086_verifySpecialCharactersInTitle"/>
                    <include name="TC_ISS_087_verifyCreateIssueOffline"/>
                    <include name="TC_ISS_088_verifyEditIssueOffline"/>
                    <include name="TC_ISS_089_verifyIssuesListLoadsQuickly"/>
                    <include name="TC_ISS_090_verifyScrollingPerformance"/>
                    <include name="TC_ISS_091_verifySubcategoryFieldForNFPA70B"/>
                    <include name="TC_ISS_092_verifyNFPA70BSubcategoryDropdownOpens"/>
                    <include name="TC_ISS_093_verifyChapter28_3_2_MotorControlCleaning"/>
                    <include name="TC_ISS_094_verifyChapter28_3_1_VisualInspections"/>
                    <include name="TC_ISS_095_verifyChapter15_3_2_CircuitBreakers"/>
                    <include name="TC_ISS_096_verifyChapter15_3_1_VisualInspections"/>
                    <include name="TC_ISS_097_verifyChapter25_3_2_UPSCleaning"/>
                    <include name="TC_ISS_098_verifyChapter25_3_1_VisualInspections"/>
                    <include name="TC_ISS_099_verifyChapter11_3_2_TransformerCleaning"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- ======================================== -->
    <!-- 2. ISSUES PHASE 2 — Thermal Anomaly + Timeouts (17 tests) -->
    <!--    Root cause: changeIssueClassOnDetails silent fail + session hangs -->
    <!--    Fix: boolean return + coordinate Strategy 3 + assertTrue -->
    <!-- ======================================== -->
    <test name="2. Issues Phase 2 - Thermal Anomaly + Timeouts (17 tests)">
        <classes>
            <class name="com.egalvanic.tests.Issue_Phase2_Test">
                <methods>
                    <!-- Timeout failures -->
                    <include name="TC_ISS_120_verifyOSHASubcategoryDropdownOptions"/>
                    <include name="TC_ISS_134_verifyOSHASubcategoriesDifferentFromNEC"/>
                    <include name="TC_ISS_135_verifyOSHASubcategoriesDifferentFromNFPA"/>
                    <include name="TC_ISS_136_verifyAllOSHASubcategoryCount"/>
                    <!-- Thermal Anomaly field verification failures -->
                    <include name="TC_ISS_159_verifyProblemTempFieldIsRequired"/>
                    <include name="TC_ISS_160_verifyEnteringProblemTempNumber"/>
                    <include name="TC_ISS_161_verifyProblemTempNumericKeyboard"/>
                    <include name="TC_ISS_162_verifyReferenceTempFieldIsRequired"/>
                    <include name="TC_ISS_163_verifyEnteringReferenceTempNumber"/>
                    <include name="TC_ISS_164_verifyCurrentDrawTableStructure"/>
                    <include name="TC_ISS_165_verifyEnteringCurrentDrawValues"/>
                    <include name="TC_ISS_166_verifyCurrentDrawIsOptional"/>
                    <include name="TC_ISS_167_verifyVoltageDropTableStructure"/>
                    <include name="TC_ISS_168_verifyEnteringVoltageDropValues"/>
                    <include name="TC_ISS_169_verifyVoltageDropIsOptional"/>
                    <include name="TC_ISS_170_verifyRequiredFieldsOnlyToggle"/>
                    <include name="TC_ISS_171_verifyRequiredFieldsShows3of3WhenComplete"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- ======================================== -->
    <!-- 3. ISSUES PHASE 3 — Sort + Badge + Swipe (12 tests) -->
    <!--    Root cause: O(N log N) sort + case-sensitive badge + swipe gesture -->
    <!--    Fix: cached Y sort + ==[c] predicate + dragFromToForDuration -->
    <!-- ======================================== -->
    <test name="3. Issues Phase 3 - Sort + Badge + Swipe (12 tests)">
        <classes>
            <class name="com.egalvanic.tests.Issue_Phase3_Test">
                <methods>
                    <!-- In Progress badge case-sensitivity -->
                    <include name="TC_ISS_189_verifyInProgressBadgeOnIssueEntry"/>
                    <!-- Swipe-to-delete gesture -->
                    <include name="TC_ISS_211_verifyDeleteConfirmationFromSwipe"/>
                    <include name="TC_ISS_212_verifyIssueRemovedAfterSwipeDelete"/>
                    <!-- Sort timeout failures (from getVisibleIssueTitles O(N log N)) -->
                    <include name="TC_ISS_228_verifySortByCreatedDate"/>
                    <include name="TC_ISS_229_verifySortByModifiedDate"/>
                    <include name="TC_ISS_230_verifySortByTitle"/>
                    <include name="TC_ISS_231_verifySortByStatus"/>
                    <include name="TC_ISS_232_verifySortPersistsAcrossNavigation"/>
                    <include name="TC_ISS_233_verifySortWorksWithFilters"/>
                    <include name="TC_ISS_234_verifyTapOutsideClosesSortDropdown"/>
                    <include name="TC_ISS_235_verifyOnlyOneSortActive"/>
                    <include name="TC_ISS_237_verifySortAppliesOnAllFilter"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- ======================================== -->
    <!-- 4. CONNECTIONS — Format + Cancel + Misc (7 tests) -->
    <!--    Root cause: arrow char mismatch + Sheet dialog + timeouts -->
    <!--    Fix: broadened arrow matching + Sheet lookup + misc -->
    <!-- ======================================== -->
    <test name="4. Connections - Format + Cancel + Misc (7 tests)">
        <classes>
            <class name="com.egalvanic.tests.Connections_Test">
                <methods>
                    <include name="TC_CONN_005_verifyConnectionEntryFormat"/>
                    <include name="TC_CONN_021_verifyAssetListShowsNameAndClass"/>
                    <include name="TC_CONN_024_verifyChangingSourceNodeSelection"/>
                    <include name="TC_CONN_059_verifyKeyboardDismissOnSelection"/>
                    <include name="TC_CONN_062_verifyRapidMultipleConnectionCreation"/>
                    <include name="TC_CONN_063_verifyCanCreateConnectionOffline"/>
                    <include name="TC_CONN_087_verifyCancelOnDeleteConfirmation"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- ======================================== -->
    <!-- 5. LOCATION — Context Menu + Known App Bugs (4 tests) -->
    <!--    Root cause: tap coordinate in nav bar + real app bugs -->
    <!--    Fix: tap at bottom + TC_NB_006/007 marked as SkipException -->
    <!-- ======================================== -->
    <test name="5. Location - Context Menu + App Bugs (4 tests)">
        <classes>
            <class name="com.egalvanic.tests.LocationTest">
                <methods>
                    <!-- Known app bugs — will show as SKIPPED -->
                    <include name="TC_NB_006_verifyBuildingNameWhitespaceValidation"/>
                    <include name="TC_NB_007_verifyBuildingNameMaximumLength"/>
                    <!-- Context menu dismiss fix -->
                    <include name="TC_BL_003_verifyTappingOutsideClosesContextMenu"/>
                    <!-- New Floor timeout -->
                    <include name="TC_NF_001_verifyNewFloorScreenUIElements"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- ======================================== -->
    <!-- 6. SITE — Dashboard Detection (1 test) -->
    <!--    Root cause: selectRandomSite() picks large slow site -->
    <!--    Fix: replaced with selectFirstSiteFast() -->
    <!-- ======================================== -->
    <test name="6. Site - Dashboard Detection (1 test)">
        <classes>
            <class name="com.egalvanic.tests.SiteSelectionTest">
                <methods>
                    <include name="TC_SS_014_verifySuccessfulSiteLoadNavigatesToDashboard"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- ======================================== -->
    <!-- 7. ASSET PHASE 5 — All tests (97 tests) -->
    <!--    Root cause: loginAndSelectSite() typed into wrong field -->
    <!--    Fix: detectCurrentScreen() before login attempt -->
    <!--    NOTE: Running full class since ALL 97 tests failed -->
    <!-- ======================================== -->
    <test name="7. Asset Phase 5 - Login Fix (97 tests)">
        <classes>
            <class name="com.egalvanic.tests.Asset_Phase5_Test"/>
        </classes>
    </test>

</suite>
