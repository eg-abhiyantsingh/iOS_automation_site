<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE suite SYSTEM "https://testng.org/testng-1.0.dtd">
<suite name="Smoke Test Suite" verbose="0" time-out="300000">
    <!-- 
    SMOKE TEST SUITE - Dynamic Tests across 6 Modules
    ===========================================================
    Purpose: S3 infrastructure check + Login → Site → CRUD validation
    
    NOTE: This root XML runs ALL 42 S3 tests (all 5 environments).
    In CI/CD, the dashboard script runs per-env S3 XMLs based on branch:
    
    Branch → S3 Environment Mapping:
      dev/develop       → dev only         (10 S3 tests) → Total 23
      qa                → qa only          (10 S3 tests) → Total 23
      staging/stage     → staging only     (10 S3 tests) → Total 23
      prod/production   → prod + bces-iq   (18 S3 tests) → Total 31
      main              → prod + bces-iq   (18 S3 tests) → Total 31
      bces-iq           → bces-iq only     (10 S3 tests) → Total 23
      unknown           → ALL environments (42 S3 tests) → Total 55
    
    Execution Order:
      Module 0 - S3 Drift Detection:  DYNAMIC (see branch mapping above, NO Appium)
      Module 1 - Login:                1 test  (Full login → Dashboard)
      Module 2 - Site Selection:       1 test  (Login + Select Site + Dashboard Badges)
      Module 3 - Asset CRUD:           4 tests (Create, Read, Update, Delete)
      Module 4 - Location CRUD:        4 tests (Create Building, Read List, Edit, Delete)
      Module 5 - Connection CRUD:      3 tests (Create, Verify in List, Delete)
    
    USAGE:
      Full smoke (all S3):   mvn test -DsuiteXmlFile=testng-smoke.xml
      S3 drift only (all):   mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-s3drift.xml
      S3 drift (qa only):    mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-s3drift-qa.xml
      S3 drift (prod+bces):  mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-s3drift-production.xml
      Login only:            mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-login.xml
      Site Selection only:   mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-site-selection.xml
      Asset CRUD only:       mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-asset-crud.xml
      Location CRUD only:    mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-location-crud.xml
      Connection CRUD only:  mvn test -DsuiteXmlFile=src/test/resources/smoke/testng-smoke-connection-crud.xml
    
    Individual module XMLs: src/test/resources/smoke/testng-smoke-*.xml
    Jira: ZP-774 (S3 Drift Detection)
    -->
    
    <listeners>
        <listener class-name="com.egalvanic.listeners.ConsoleProgressListener"/>
    </listeners>

    <!-- Module 0: S3 Drift Detection (42 tests, NO Appium) -->
    <test name="Smoke - S3 Drift Detection">
        <classes>
            <class name="com.egalvanic.tests.S3BucketPolicyDriftTest"/>
        </classes>
    </test>

    <!-- Module 1: Login (1 test) -->
    <test name="Smoke - Login">
        <classes>
            <class name="com.egalvanic.tests.AuthenticationTest">
                <methods>
                    <include name="TC25_verifyValidLoginNavigatesToDashboard"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- Module 2: Site Selection (1 test) - Login + Select Site + Dashboard Badges -->
    <test name="Smoke - Site Selection">
        <classes>
            <class name="com.egalvanic.tests.SiteSelectionTest">
                <methods>
                    <include name="TC_SS_044_verifyIssuesBadgeCount"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- Module 3: Asset CRUD (4 tests) - Create, Read, Update, Delete -->
    <test name="Smoke - Asset CRUD">
        <classes>
            <class name="com.egalvanic.tests.Asset_Phase1_Test">
                <methods>
                    <include name="ATS_ECR_31_verifySaveAssetWithValidData"/>
                    <include name="ATS_ECR_37_verifyAssetAppearsInAssetList"/>
                    <include name="ATS_EAD_01_openEditAssetDetailsScreen"/>
                </methods>
            </class>
            <class name="com.egalvanic.tests.Asset_Phase5_Test">
                <methods>
                    <include name="BUG_DELETE_01_deleteRequiresConfirmation"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- Module 4: Location CRUD (4 tests) - Create, Read, Update, Delete Building -->
    <test name="Smoke - Location CRUD">
        <classes>
            <class name="com.egalvanic.tests.LocationTest">
                <methods>
                    <include name="TC_NB_010_verifySuccessfulBuildingCreation"/>
                    <include name="TC_BL_001_verifyBuildingListDisplaysBuildings"/>
                    <include name="TC_EB_002_verifyBuildingNameCanBeUpdated"/>
                    <include name="TC_DB_001_verifyBuildingDeletedImmediatelyOnTap"/>
                </methods>
            </class>
        </classes>
    </test>

    <!-- Module 5: Connection CRUD (3 tests) - Create, Verify, Delete -->
    <test name="Smoke - Connection CRUD">
        <classes>
            <class name="com.egalvanic.tests.Connections_Test">
                <methods>
                    <include name="TC_CONN_037_verifyCreateConnectionSuccessfully"/>
                    <include name="TC_CONN_038_verifyNewConnectionAppearsInList"/>
                    <include name="TC_CONN_051_verifyConnectionDeletedSuccessfully"/>
                </methods>
            </class>
        </classes>
    </test>

</suite>
