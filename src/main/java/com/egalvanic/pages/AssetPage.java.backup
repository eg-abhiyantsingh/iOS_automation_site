package com.egalvanic.pages;

import com.egalvanic.base.BasePage;
import io.appium.java_client.AppiumBy;
import io.appium.java_client.pagefactory.iOSXCUITFindBy;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;

import java.time.Duration;
import java.util.List;
import java.util.Map;

/**
 * Asset Page Object
 * Handles all Asset Management screen interactions
 * 
 * Features covered:
 * - Asset List Screen
 * - Create Asset
 * - Edit Asset
 * - Asset Details
 * - Asset Class Selection
 * - Location Selection
 * - Asset Subtype Selection
 * - QR Code Entry
 */
public class AssetPage extends BasePage {

    // ================================================================
    // ASSET LIST SCREEN ELEMENTS
    // ================================================================

    // Asset List Button (list.bullet)
    @iOSXCUITFindBy(accessibility = "list.bullet")
    private WebElement assetListButton;

    // Plus Button (Add Asset)
    @iOSXCUITFindBy(accessibility = "plus")
    private WebElement plusButton;

    // Back Button
    @iOSXCUITFindBy(accessibility = "Back")
    private WebElement backButton;

    // Cancel Button
    @iOSXCUITFindBy(accessibility = "Cancel")
    private WebElement cancelButton;

    // ================================================================
    // CREATE/EDIT ASSET FORM ELEMENTS
    // ================================================================

    // Asset Name Field
    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeTextField' AND value == 'Enter name'")
    private WebElement assetNameField;

    // Asset Name Field Alternative (when already has value)
    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeTextField'")
    private List<WebElement> allTextFields;

    // Select Asset Class Button
    @iOSXCUITFindBy(accessibility = "Select asset class")
    private WebElement selectAssetClassButton;

    // Select Location Button
    @iOSXCUITFindBy(accessibility = "Select location")
    private WebElement selectLocationButton;

    // Select Asset Subtype Button
    @iOSXCUITFindBy(accessibility = "Select asset subtype")
    private WebElement selectAssetSubtypeButton;

    // QR Code Field
    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeTextField' AND value == 'Enter or scan QR code'")
    private WebElement qrCodeField;

    // Asset Details Header (for dismissing keyboard)
    @iOSXCUITFindBy(accessibility = "Asset Details")
    private WebElement assetDetailsHeader;

    // Create Asset Button
    @iOSXCUITFindBy(accessibility = "Create Asset")
    private WebElement createAssetButton;

    // Save Button (for editing)
    @iOSXCUITFindBy(accessibility = "Save")
    private WebElement saveButton;

    // Delete Button
    @iOSXCUITFindBy(accessibility = "Delete")
    private WebElement deleteButton;

    // ================================================================
    // ASSET CLASS OPTIONS
    // ================================================================

    @iOSXCUITFindBy(accessibility = "ATS")
    private WebElement atsClassOption;

    @iOSXCUITFindBy(accessibility = "UPS")
    private WebElement upsClassOption;

    @iOSXCUITFindBy(accessibility = "PDU")
    private WebElement pduClassOption;

    @iOSXCUITFindBy(accessibility = "Generator")
    private WebElement generatorClassOption;

    // ================================================================
    // LOCATION ELEMENTS
    // ================================================================

    // Plus Circle Fill Button (for creating new floor/room)
    @iOSXCUITFindBy(iOSClassChain = "**/XCUIElementTypeButton[`name == \"plus.circle.fill\"`][1]")
    private WebElement addFloorButton;

    @iOSXCUITFindBy(iOSClassChain = "**/XCUIElementTypeButton[`name == \"plus.circle.fill\"`][2]")
    private WebElement addRoomButton;

    // Floor Name Field
    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeTextField' AND value == 'Floor Name'")
    private WebElement floorNameField;

    // Room Name Field
    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeTextField' AND value == 'Room Name'")
    private WebElement roomNameField;

    // ================================================================
    // ASSET SUBTYPE OPTIONS
    // ================================================================

    @iOSXCUITFindBy(accessibility = "test")
    private WebElement testSubtypeOption;

    // ================================================================
    // ASSET LIST ELEMENTS
    // ================================================================

    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeButton'")
    private List<WebElement> allButtons;

    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeCell'")
    private List<WebElement> assetCells;

    // Search Bar
    @iOSXCUITFindBy(iOSNsPredicate = "type == 'XCUIElementTypeSearchField'")
    private WebElement searchBar;

    // ================================================================
    // CONSTRUCTOR
    // ================================================================

    public AssetPage() {
        super();
    }

    // ================================================================
    // NAVIGATION METHODS
    // ================================================================

    /**
     * Navigate to Asset List screen
     */
    public void navigateToAssetList() {
        System.out.println("üì¶ Navigating to Asset List...");
        click(assetListButton);
        waitForAssetListReady();
    }

    /**
     * Click Plus button to add new asset
     */
    public void clickAddAsset() {
        System.out.println("‚ûï Clicking Add Asset button...");
        click(plusButton);
        waitForCreateAssetFormReady();
    }

    /**
     * Click Back button
     */
    public void clickBack() {
        click(backButton);
    }

    /**
     * Click Cancel button
     */
    public void clickCancel() {
        click(cancelButton);
    }

    // ================================================================
    // WAIT METHODS
    // ================================================================

    /**
     * Wait for Asset List screen to be ready
     */
    public void waitForAssetListReady() {
        try {
            WebDriverWait quickWait = new WebDriverWait(driver, Duration.ofSeconds(5));
            quickWait.until(ExpectedConditions.or(
                ExpectedConditions.visibilityOf(plusButton),
                ExpectedConditions.presenceOfElementLocated(AppiumBy.accessibilityId("plus"))
            ));
            System.out.println("‚úÖ Asset List ready");
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Asset List wait timeout: " + e.getMessage());
        }
    }

    /**
     * Wait for Create Asset form to be ready
     */
    public void waitForCreateAssetFormReady() {
        try {
            WebDriverWait quickWait = new WebDriverWait(driver, Duration.ofSeconds(5));
            quickWait.until(ExpectedConditions.or(
                ExpectedConditions.visibilityOf(assetNameField),
                ExpectedConditions.presenceOfElementLocated(
                    AppiumBy.iOSNsPredicateString("type == 'XCUIElementTypeTextField' AND value == 'Enter name'")
                )
            ));
            System.out.println("‚úÖ Create Asset form ready");
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Create Asset form wait timeout: " + e.getMessage());
        }
    }

    // ================================================================
    // ASSET LIST METHODS
    // ================================================================

    /**
     * Check if Asset List screen is displayed
     */
    public boolean isAssetListDisplayed() {
        return isElementDisplayed(plusButton) || isElementDisplayed(assetListButton);
    }

    /**
     * Check if Plus button is displayed
     */
    public boolean isPlusButtonDisplayed() {
        return isElementDisplayed(plusButton);
    }

    /**
     * Get asset count from list
     */
    public int getAssetCount() {
        try {
            return assetCells.size();
        } catch (Exception e) {
            return 0;
        }
    }

    /**
     * Search for asset by name
     */
    public void searchAsset(String assetName) {
        try {
            if (isElementDisplayed(searchBar)) {
                click(searchBar);
                searchBar.sendKeys(assetName);
                System.out.println("‚úÖ Searched for asset: " + assetName);
            }
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Search bar not available: " + e.getMessage());
        }
    }

    /**
     * Select asset by name from list
     */
    public boolean selectAssetByName(String assetName) {
        try {
            for (WebElement btn : allButtons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(assetName)) {
                    btn.click();
                    System.out.println("‚úÖ Selected asset: " + name);
                    return true;
                }
            }
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not select asset: " + e.getMessage());
        }
        return false;
    }

    /**
     * Select first asset from list
     */
    public String selectFirstAsset() {
        try {
            if (assetCells.size() > 0) {
                String name = assetCells.get(0).getAttribute("name");
                assetCells.get(0).click();
                return name;
            }
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not select first asset: " + e.getMessage());
        }
        return null;
    }

    // ================================================================
    // CREATE ASSET FORM METHODS
    // ================================================================

    /**
     * Check if Create Asset form is displayed
     */
    public boolean isCreateAssetFormDisplayed() {
        return isElementDisplayed(assetNameField) || isElementDisplayed(selectAssetClassButton);
    }

    /**
     * Check if Asset Name field is displayed
     */
    public boolean isAssetNameFieldDisplayed() {
        return isElementDisplayed(assetNameField);
    }

    /**
     * Enter asset name
     */
    public void enterAssetName(String name) {
        try {
            WebElement nameField = driver.findElement(
                AppiumBy.iOSNsPredicateString("type == 'XCUIElementTypeTextField' AND value == 'Enter name'")
            );
            nameField.sendKeys(name);
            System.out.println("‚úÖ Entered asset name: " + name);
        } catch (Exception e) {
            // Try alternative - first text field
            if (allTextFields.size() > 0) {
                allTextFields.get(0).sendKeys(name);
                System.out.println("‚úÖ Entered asset name (alt): " + name);
            }
        }
    }

    /**
     * Get asset name field value
     */
    public String getAssetNameValue() {
        try {
            return assetNameField.getAttribute("value");
        } catch (Exception e) {
            return "";
        }
    }

    /**
     * Clear asset name field
     */
    public void clearAssetName() {
        try {
            assetNameField.clear();
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not clear asset name: " + e.getMessage());
        }
    }

    /**
     * Check if Select Asset Class button is displayed
     */
    public boolean isSelectAssetClassDisplayed() {
        return isElementDisplayed(selectAssetClassButton);
    }

    /**
     * Click Select Asset Class button
     */
    public void clickSelectAssetClass() {
        click(selectAssetClassButton);
        System.out.println("‚úÖ Clicked Select Asset Class");
    }

    /**
     * Select asset class by name
     */
    public void selectAssetClass(String className) {
        clickSelectAssetClass();
        sleep(500);
        try {
            WebElement classOption = driver.findElement(AppiumBy.accessibilityId(className));
            classOption.click();
            System.out.println("‚úÖ Selected asset class: " + className);
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not select asset class: " + className);
        }
    }

    /**
     * Select ATS asset class
     */
    public void selectATSClass() {
        clickSelectAssetClass();
        sleep(500);
        click(atsClassOption);
        System.out.println("‚úÖ Selected ATS class");
    }

    /**
     * Check if Select Location button is displayed
     */
    public boolean isSelectLocationDisplayed() {
        return isElementDisplayed(selectLocationButton);
    }

    /**
     * Click Select Location button
     */
    public void clickSelectLocation() {
        click(selectLocationButton);
        System.out.println("‚úÖ Clicked Select Location");
    }


    /**
     * Select location from hierarchy (Building > Floor > Room)
     * Returns true if location was selected successfully
     */
    public boolean selectLocation() {
        clickSelectLocation();
        sleep(1000);
        
        try {
            List<WebElement> buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
            
            // Find and click building (contains " floor" in name)
            for (WebElement btn : buttons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(" floor")) {
                    btn.click();
                    System.out.println("‚úÖ Selected building: " + name);
                    sleep(500);
                    
                    // Find and click floor
                    buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
                    for (WebElement floorBtn : buttons) {
                        String fName = floorBtn.getAttribute("name");
                        if (fName != null && !fName.contains(" floor") &&
                            (fName.contains(" room") || fName.startsWith("Floor_") || fName.startsWith("1_Floor"))) {
                            floorBtn.click();
                            System.out.println("‚úÖ Selected floor: " + fName);
                            sleep(500);
                            
                            // Find and click room
                            buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
                            for (WebElement roomBtn : buttons) {
                                String rName = roomBtn.getAttribute("name");
                                if (rName != null && (rName.contains(">") || rName.startsWith("Room_")) &&
                                    !rName.contains(" floor") && !rName.contains(" room")) {
                                    roomBtn.click();
                                    System.out.println("‚úÖ Selected room: " + rName);
                                    return true;
                                }
                            }
                            break;
                        }
                    }
                    break;
                }
            }
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Error selecting location: " + e.getMessage());
        }
        
        return false;
    }

    /**
     * Create new location (Floor and Room) if none exists
     */
    public void createNewLocation(String floorName, String roomName) {
        System.out.println("üìç Creating new location...");
        
        try {
            // Click first plus.circle.fill to add floor
            click(addFloorButton);
            sleep(500);
            
            // Enter floor name
            WebElement floorField = driver.findElement(
                AppiumBy.iOSNsPredicateString("type == 'XCUIElementTypeTextField' AND value == 'Floor Name'")
            );
            floorField.sendKeys(floorName);
            click(saveButton);
            System.out.println("‚úÖ Created floor: " + floorName);
            sleep(500);
            
            // Select the newly created floor
            List<WebElement> buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
            for (WebElement btn : buttons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(floorName)) {
                    btn.click();
                    break;
                }
            }
            sleep(500);
            
            // Click second plus.circle.fill to add room
            click(addRoomButton);
            sleep(500);
            
            // Enter room name
            WebElement roomField = driver.findElement(
                AppiumBy.iOSNsPredicateString("type == 'XCUIElementTypeTextField' AND value == 'Room Name'")
            );
            roomField.sendKeys(roomName);
            click(saveButton);
            System.out.println("‚úÖ Created room: " + roomName);
            sleep(500);
            
            // Navigate back and select the location
            buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
            for (WebElement btn : buttons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(" floor")) {
                    btn.click();
                    break;
                }
            }
            sleep(500);
            
            buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
            for (WebElement btn : buttons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(floorName)) {
                    btn.click();
                    break;
                }
            }
            sleep(500);
            
            buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
            for (WebElement btn : buttons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(roomName)) {
                    btn.click();
                    System.out.println("‚úÖ Selected room: " + name);
                    break;
                }
            }
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Error creating location: " + e.getMessage());
        }
    }

    /**
     * Check if Select Asset Subtype button is displayed
     */
    public boolean isSelectAssetSubtypeDisplayed() {
        return isElementDisplayed(selectAssetSubtypeButton);
    }

    /**
     * Click Select Asset Subtype button
     */
    public void clickSelectAssetSubtype() {
        click(selectAssetSubtypeButton);
        System.out.println("‚úÖ Clicked Select Asset Subtype");
    }

    /**
     * Select asset subtype by name
     */
    public void selectAssetSubtype(String subtypeName) {
        clickSelectAssetSubtype();
        sleep(500);
        try {
            WebElement subtypeOption = driver.findElement(AppiumBy.accessibilityId(subtypeName));
            subtypeOption.click();
            System.out.println("‚úÖ Selected asset subtype: " + subtypeName);
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not select asset subtype: " + subtypeName);
        }
    }

    /**
     * Check if QR Code field is displayed
     */
    public boolean isQRCodeFieldDisplayed() {
        return isElementDisplayed(qrCodeField);
    }

    /**
     * Enter QR code
     */
    public void enterQRCode(String qrCode) {
        try {
            WebElement qrField = driver.findElement(
                AppiumBy.iOSNsPredicateString("type == 'XCUIElementTypeTextField' AND value == 'Enter or scan QR code'")
            );
            qrField.sendKeys(qrCode);
            System.out.println("‚úÖ Entered QR code: " + qrCode);
            dismissKeyboard();
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not enter QR code: " + e.getMessage());
        }
    }

    /**
     * Get QR code field value
     */
    public String getQRCodeValue() {
        try {
            return qrCodeField.getAttribute("value");
        } catch (Exception e) {
            return "";
        }
    }

    /**
     * Dismiss keyboard by tapping on Asset Details header
     */
    public void dismissKeyboard() {
        try {
            click(assetDetailsHeader);
        } catch (Exception e) {
            // Try tapping outside
            try {
                driver.executeScript("mobile: tap", Map.of("x", 200, "y", 100));
            } catch (Exception ex) {
                System.out.println("‚ö†Ô∏è Could not dismiss keyboard");
            }
        }
    }

    /**
     * Scroll down on the form
     */
    public void scrollFormDown() {
        try {
            driver.executeScript("mobile: scroll", Map.of("direction", "down"));
            System.out.println("‚úÖ Scrolled down");
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not scroll: " + e.getMessage());
        }
    }

    /**
     * Scroll up on the form
     */
    public void scrollFormUp() {
        try {
            driver.executeScript("mobile: scroll", Map.of("direction", "up"));
            System.out.println("‚úÖ Scrolled up");
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not scroll: " + e.getMessage());
        }
    }

    /**
     * Check if Create Asset button is displayed
     */
    public boolean isCreateAssetButtonDisplayed() {
        return isElementDisplayed(createAssetButton);
    }

    /**
     * Check if Create Asset button is enabled
     */
    public boolean isCreateAssetButtonEnabled() {
        try {
            String enabled = createAssetButton.getAttribute("enabled");
            return "true".equalsIgnoreCase(enabled);
        } catch (Exception e) {
            return false;
        }
    }

    /**
     * Click Create Asset button
     */
    public void clickCreateAsset() {
        scrollFormUp();
        sleep(500);
        click(createAssetButton);
        System.out.println("‚úÖ Clicked Create Asset");
    }

    /**
     * Check if Save button is displayed
     */
    public boolean isSaveButtonDisplayed() {
        return isElementDisplayed(saveButton);
    }

    /**
     * Click Save button
     */
    public void clickSave() {
        click(saveButton);
        System.out.println("‚úÖ Clicked Save");
    }

    /**
     * Check if Delete button is displayed
     */
    public boolean isDeleteButtonDisplayed() {
        return isElementDisplayed(deleteButton);
    }

    /**
     * Click Delete button
     */
    public void clickDelete() {
        click(deleteButton);
        System.out.println("‚úÖ Clicked Delete");
    }

    // ================================================================
    // COMPLETE ASSET CREATION FLOW
    // ================================================================

    /**
     * Create a complete asset with all required fields
     * Returns the created asset name
     */
    public String createAsset(String assetName, String assetClass, String subtype, String qrCode) {
        System.out.println("\nüì¶ CREATING ASSET: " + assetName);
        
        // 1. Enter name
        enterAssetName(assetName);
        
        // 2. Select asset class
        selectAssetClass(assetClass);
        
        // 3. Select location
        boolean locationSelected = selectLocation();
        if (!locationSelected) {
            String timestamp = String.valueOf(System.currentTimeMillis());
            createNewLocation("Floor_" + timestamp, "Room_" + timestamp);
        }
        
        // 4. Dismiss keyboard and scroll
        dismissKeyboard();
        scrollFormDown();
        
        // 5. Select subtype if provided
        if (subtype != null && !subtype.isEmpty()) {
            try {
                selectAssetSubtype(subtype);
            } catch (Exception e) {
                System.out.println("‚ö†Ô∏è Subtype selection skipped: " + e.getMessage());
            }
        }
        
        // 6. Enter QR code if provided
        if (qrCode != null && !qrCode.isEmpty()) {
            enterQRCode(qrCode);
        }
        
        // 7. Create asset
        clickCreateAsset();
        
        System.out.println("‚úÖ‚úÖ‚úÖ ASSET CREATED: " + assetName + " ‚úÖ‚úÖ‚úÖ\n");
        return assetName;
    }

    /**
     * Create asset with auto-generated name
     */
    public String createAssetWithAutoName(String assetClass) {
        long timestamp = System.currentTimeMillis();
        String assetName = "Asset_" + timestamp;
        String qrCode = "QR_" + timestamp;
        return createAsset(assetName, assetClass, "test", qrCode);
    }

    /**
     * Create ATS asset with auto-generated name
     */
    public String createATSAsset() {
        return createAssetWithAutoName("ATS");
    }

    // ================================================================
    // VALIDATION METHODS
    // ================================================================

    /**
     * Check if asset was created successfully (navigated back to list)
     */
    public boolean isAssetCreatedSuccessfully() {
        sleep(2000);
        return isAssetListDisplayed() || !isCreateAssetFormDisplayed();
    }

    /**
     * Check if required field error is displayed
     */
    public boolean isRequiredFieldErrorDisplayed() {
        try {
            WebElement error = driver.findElement(
                AppiumBy.iOSNsPredicateString("label CONTAINS 'required' OR label CONTAINS 'Required'")
            );
            return error.isDisplayed();
        } catch (Exception e) {
            return false;
        }
    }

    /**
     * Check if asset class dropdown is displayed
     */
    public boolean isAssetClassDropdownDisplayed() {
        try {
            return isElementDisplayed(atsClassOption) || 
                   isElementDisplayed(upsClassOption) ||
                   isElementDisplayed(pduClassOption);
        } catch (Exception e) {
            return false;
        }
    }

    /**
     * Check if location picker is displayed
     */
    public boolean isLocationPickerDisplayed() {
        try {
            List<WebElement> buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
            for (WebElement btn : buttons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(" floor")) {
                    return true;
                }
            }
        } catch (Exception e) {
            // Ignore
        }
        return false;
    }

    /**
     * Check if subtype dropdown is displayed
     */
    public boolean isSubtypeDropdownDisplayed() {
        try {
            return isElementDisplayed(testSubtypeOption);
        } catch (Exception e) {
            return false;
        }
    }

    /**
     * Get all available asset classes
     */
    public List<String> getAvailableAssetClasses() {
        List<String> classes = new java.util.ArrayList<>();
        clickSelectAssetClass();
        sleep(500);
        
        try {
            List<WebElement> options = driver.findElements(
                AppiumBy.iOSNsPredicateString("type == 'XCUIElementTypeButton' OR type == 'XCUIElementTypeStaticText'")
            );
            for (WebElement option : options) {
                String name = option.getAttribute("name");
                if (name != null && !name.isEmpty() && 
                    !name.equals("Select asset class") && !name.equals("Cancel")) {
                    classes.add(name);
                }
            }
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Could not get asset classes: " + e.getMessage());
        }
        
        // Dismiss dropdown
        try {
            clickCancel();
        } catch (Exception e) {
            // Ignore
        }
        
        return classes;
    }

    /**
     * Verify asset exists in list by name
     */
    public boolean verifyAssetExistsInList(String assetName) {
        try {
            List<WebElement> buttons = driver.findElements(AppiumBy.className("XCUIElementTypeButton"));
            for (WebElement btn : buttons) {
                String name = btn.getAttribute("name");
                if (name != null && name.contains(assetName)) {
                    return true;
                }
            }
        } catch (Exception e) {
            System.out.println("‚ö†Ô∏è Error verifying asset: " + e.getMessage());
        }
        return false;
    }
}
