name: iOS Tests - Quick Verification

# ============================================================
# QUICK VERIFICATION WORKFLOW - v2.0 (ROBUST)
# ============================================================
# Tests: 1-2 tests per job (12 total)
# Expected Time: ~25-40 minutes
# 
# FIXES in v2.0:
#   - Increased simulator boot wait (30s â†’ 90s)
#   - Better Appium startup with retry logic
#   - Fixed EISDIR error in email attachments
# ============================================================

on:
  push:
    branches:
      - main
      - develop
  workflow_dispatch:
    inputs:
      send_email:
        description: 'Send email with reports'
        required: false
        default: 'true'
        type: choice
        options:
          - 'true'
          - 'false'

env:
  SIMULATOR_BOOT_WAIT: 90
  APPIUM_MAX_RETRIES: 120

jobs:
  auth-quick:
    runs-on: macos-15
    timeout-minutes: 25
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Appium
        run: |
          npm install -g appium@2.5.0
          appium driver install xcuitest@7.9.1
      - name: Unzip App
        run: unzip -o apps/Z-Platform-QA.zip -d apps/
      - name: Boot Simulator
        run: |
          UDID=$(xcrun simctl list devices available | grep -E "iPhone 16 Pro" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && UDID=$(xcrun simctl list devices available | grep -E "iPhone 1[456]" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && exit 1
          xcrun simctl boot "$UDID" 2>/dev/null || true
          sleep ${{ env.SIMULATOR_BOOT_WAIT }}
          DEVICE=$(xcrun simctl list devices | grep "$UDID" | sed 's/ (.*//g' | xargs)
          VERSION=$(xcrun simctl list devices | grep -B 100 "$UDID" | grep "-- iOS" | tail -1 | sed 's/.*iOS \([0-9.]*\).*/\1/')
          echo "SIMULATOR_UDID=$UDID" >> $GITHUB_ENV
          echo "DEVICE_NAME=$DEVICE" >> $GITHUB_ENV
          echo "PLATFORM_VERSION=$VERSION" >> $GITHUB_ENV
      - name: Pre-install App
        run: xcrun simctl install "${{ env.SIMULATOR_UDID }}" "apps/Z Platform-QA.app"
      - name: Start Appium
        run: |
          appium --relaxed-security --log-level info --port 4723 > appium.log 2>&1 &
          for i in $(seq 1 ${{ env.APPIUM_MAX_RETRIES }}); do
            curl -s http://127.0.0.1:4723/status 2>/dev/null | grep -q "ready" && echo "Appium ready" && exit 0
            sleep 2
          done
          cat appium.log | tail -30 && exit 1
      - name: Run Tests
        continue-on-error: true
        run: |
          mvn test -DsuiteXmlFile=src/test/resources/parallel-quick/testng-auth-quick.xml \
            -DDEVICE_NAME="${{ env.DEVICE_NAME }}" \
            -DPLATFORM_VERSION="${{ env.PLATFORM_VERSION }}" \
            -DSIMULATOR_UDID="${{ env.SIMULATOR_UDID }}" \
            -DAPP_PATH="${{ github.workspace }}/apps/Z Platform-QA.app"
      - name: Upload Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: auth-quick-report
          path: |
            target/surefire-reports/
            reports/
            screenshots/
          retention-days: 3
          if-no-files-found: warn

  site-quick:
    runs-on: macos-15
    timeout-minutes: 25
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Appium
        run: |
          npm install -g appium@2.5.0
          appium driver install xcuitest@7.9.1
      - name: Unzip App
        run: unzip -o apps/Z-Platform-QA.zip -d apps/
      - name: Boot Simulator
        run: |
          UDID=$(xcrun simctl list devices available | grep -E "iPhone 16 Pro" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && UDID=$(xcrun simctl list devices available | grep -E "iPhone 1[456]" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && exit 1
          xcrun simctl boot "$UDID" 2>/dev/null || true
          sleep ${{ env.SIMULATOR_BOOT_WAIT }}
          DEVICE=$(xcrun simctl list devices | grep "$UDID" | sed 's/ (.*//g' | xargs)
          VERSION=$(xcrun simctl list devices | grep -B 100 "$UDID" | grep "-- iOS" | tail -1 | sed 's/.*iOS \([0-9.]*\).*/\1/')
          echo "SIMULATOR_UDID=$UDID" >> $GITHUB_ENV
          echo "DEVICE_NAME=$DEVICE" >> $GITHUB_ENV
          echo "PLATFORM_VERSION=$VERSION" >> $GITHUB_ENV
      - name: Pre-install App
        run: xcrun simctl install "${{ env.SIMULATOR_UDID }}" "apps/Z Platform-QA.app"
      - name: Start Appium
        run: |
          appium --relaxed-security --log-level info --port 4723 > appium.log 2>&1 &
          for i in $(seq 1 ${{ env.APPIUM_MAX_RETRIES }}); do
            curl -s http://127.0.0.1:4723/status 2>/dev/null | grep -q "ready" && exit 0
            sleep 2
          done
          cat appium.log | tail -30 && exit 1
      - name: Run Tests
        continue-on-error: true
        run: |
          mvn test -DsuiteXmlFile=src/test/resources/parallel-quick/testng-site-quick.xml \
            -DDEVICE_NAME="${{ env.DEVICE_NAME }}" \
            -DPLATFORM_VERSION="${{ env.PLATFORM_VERSION }}" \
            -DSIMULATOR_UDID="${{ env.SIMULATOR_UDID }}" \
            -DAPP_PATH="${{ github.workspace }}/apps/Z Platform-QA.app"
      - name: Upload Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: site-quick-report
          path: |
            target/surefire-reports/
            reports/
            screenshots/
          retention-days: 3
          if-no-files-found: warn

  phase1-quick:
    runs-on: macos-15
    timeout-minutes: 30
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Appium
        run: |
          npm install -g appium@2.5.0
          appium driver install xcuitest@7.9.1
      - name: Unzip App
        run: unzip -o apps/Z-Platform-QA.zip -d apps/
      - name: Boot Simulator
        run: |
          UDID=$(xcrun simctl list devices available | grep -E "iPhone 16 Pro" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && UDID=$(xcrun simctl list devices available | grep -E "iPhone 1[456]" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && exit 1
          xcrun simctl boot "$UDID" 2>/dev/null || true
          sleep ${{ env.SIMULATOR_BOOT_WAIT }}
          DEVICE=$(xcrun simctl list devices | grep "$UDID" | sed 's/ (.*//g' | xargs)
          VERSION=$(xcrun simctl list devices | grep -B 100 "$UDID" | grep "-- iOS" | tail -1 | sed 's/.*iOS \([0-9.]*\).*/\1/')
          echo "SIMULATOR_UDID=$UDID" >> $GITHUB_ENV
          echo "DEVICE_NAME=$DEVICE" >> $GITHUB_ENV
          echo "PLATFORM_VERSION=$VERSION" >> $GITHUB_ENV
      - name: Pre-install App
        run: xcrun simctl install "${{ env.SIMULATOR_UDID }}" "apps/Z Platform-QA.app"
      - name: Start Appium
        run: |
          appium --relaxed-security --log-level info --port 4723 > appium.log 2>&1 &
          for i in $(seq 1 ${{ env.APPIUM_MAX_RETRIES }}); do
            curl -s http://127.0.0.1:4723/status 2>/dev/null | grep -q "ready" && exit 0
            sleep 2
          done
          cat appium.log | tail -30 && exit 1
      - name: Run Tests
        continue-on-error: true
        run: |
          mvn test -DsuiteXmlFile=src/test/resources/parallel-quick/testng-phase1-quick.xml \
            -DDEVICE_NAME="${{ env.DEVICE_NAME }}" \
            -DPLATFORM_VERSION="${{ env.PLATFORM_VERSION }}" \
            -DSIMULATOR_UDID="${{ env.SIMULATOR_UDID }}" \
            -DAPP_PATH="${{ github.workspace }}/apps/Z Platform-QA.app"
      - name: Upload Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: phase1-quick-report
          path: |
            target/surefire-reports/
            reports/
            screenshots/
          retention-days: 3
          if-no-files-found: warn

  phase2-quick:
    runs-on: macos-15
    timeout-minutes: 30
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Appium
        run: |
          npm install -g appium@2.5.0
          appium driver install xcuitest@7.9.1
      - name: Unzip App
        run: unzip -o apps/Z-Platform-QA.zip -d apps/
      - name: Boot Simulator
        run: |
          UDID=$(xcrun simctl list devices available | grep -E "iPhone 16 Pro" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && UDID=$(xcrun simctl list devices available | grep -E "iPhone 1[456]" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && exit 1
          xcrun simctl boot "$UDID" 2>/dev/null || true
          sleep ${{ env.SIMULATOR_BOOT_WAIT }}
          DEVICE=$(xcrun simctl list devices | grep "$UDID" | sed 's/ (.*//g' | xargs)
          VERSION=$(xcrun simctl list devices | grep -B 100 "$UDID" | grep "-- iOS" | tail -1 | sed 's/.*iOS \([0-9.]*\).*/\1/')
          echo "SIMULATOR_UDID=$UDID" >> $GITHUB_ENV
          echo "DEVICE_NAME=$DEVICE" >> $GITHUB_ENV
          echo "PLATFORM_VERSION=$VERSION" >> $GITHUB_ENV
      - name: Pre-install App
        run: xcrun simctl install "${{ env.SIMULATOR_UDID }}" "apps/Z Platform-QA.app"
      - name: Start Appium
        run: |
          appium --relaxed-security --log-level info --port 4723 > appium.log 2>&1 &
          for i in $(seq 1 ${{ env.APPIUM_MAX_RETRIES }}); do
            curl -s http://127.0.0.1:4723/status 2>/dev/null | grep -q "ready" && exit 0
            sleep 2
          done
          cat appium.log | tail -30 && exit 1
      - name: Run Tests
        continue-on-error: true
        run: |
          mvn test -DsuiteXmlFile=src/test/resources/parallel-quick/testng-phase2-quick.xml \
            -DDEVICE_NAME="${{ env.DEVICE_NAME }}" \
            -DPLATFORM_VERSION="${{ env.PLATFORM_VERSION }}" \
            -DSIMULATOR_UDID="${{ env.SIMULATOR_UDID }}" \
            -DAPP_PATH="${{ github.workspace }}/apps/Z Platform-QA.app"
      - name: Upload Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: phase2-quick-report
          path: |
            target/surefire-reports/
            reports/
            screenshots/
          retention-days: 3
          if-no-files-found: warn

  phase3-quick:
    runs-on: macos-15
    timeout-minutes: 30
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Appium
        run: |
          npm install -g appium@2.5.0
          appium driver install xcuitest@7.9.1
      - name: Unzip App
        run: unzip -o apps/Z-Platform-QA.zip -d apps/
      - name: Boot Simulator
        run: |
          UDID=$(xcrun simctl list devices available | grep -E "iPhone 16 Pro" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && UDID=$(xcrun simctl list devices available | grep -E "iPhone 1[456]" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && exit 1
          xcrun simctl boot "$UDID" 2>/dev/null || true
          sleep ${{ env.SIMULATOR_BOOT_WAIT }}
          DEVICE=$(xcrun simctl list devices | grep "$UDID" | sed 's/ (.*//g' | xargs)
          VERSION=$(xcrun simctl list devices | grep -B 100 "$UDID" | grep "-- iOS" | tail -1 | sed 's/.*iOS \([0-9.]*\).*/\1/')
          echo "SIMULATOR_UDID=$UDID" >> $GITHUB_ENV
          echo "DEVICE_NAME=$DEVICE" >> $GITHUB_ENV
          echo "PLATFORM_VERSION=$VERSION" >> $GITHUB_ENV
      - name: Pre-install App
        run: xcrun simctl install "${{ env.SIMULATOR_UDID }}" "apps/Z Platform-QA.app"
      - name: Start Appium
        run: |
          appium --relaxed-security --log-level info --port 4723 > appium.log 2>&1 &
          for i in $(seq 1 ${{ env.APPIUM_MAX_RETRIES }}); do
            curl -s http://127.0.0.1:4723/status 2>/dev/null | grep -q "ready" && exit 0
            sleep 2
          done
          cat appium.log | tail -30 && exit 1
      - name: Run Tests
        continue-on-error: true
        run: |
          mvn test -DsuiteXmlFile=src/test/resources/parallel-quick/testng-phase3-quick.xml \
            -DDEVICE_NAME="${{ env.DEVICE_NAME }}" \
            -DPLATFORM_VERSION="${{ env.PLATFORM_VERSION }}" \
            -DSIMULATOR_UDID="${{ env.SIMULATOR_UDID }}" \
            -DAPP_PATH="${{ github.workspace }}/apps/Z Platform-QA.app"
      - name: Upload Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: phase3-quick-report
          path: |
            target/surefire-reports/
            reports/
            screenshots/
          retention-days: 3
          if-no-files-found: warn

  phase4-quick:
    runs-on: macos-15
    timeout-minutes: 30
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Appium
        run: |
          npm install -g appium@2.5.0
          appium driver install xcuitest@7.9.1
      - name: Unzip App
        run: unzip -o apps/Z-Platform-QA.zip -d apps/
      - name: Boot Simulator
        run: |
          UDID=$(xcrun simctl list devices available | grep -E "iPhone 16 Pro" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && UDID=$(xcrun simctl list devices available | grep -E "iPhone 1[456]" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && exit 1
          xcrun simctl boot "$UDID" 2>/dev/null || true
          sleep ${{ env.SIMULATOR_BOOT_WAIT }}
          DEVICE=$(xcrun simctl list devices | grep "$UDID" | sed 's/ (.*//g' | xargs)
          VERSION=$(xcrun simctl list devices | grep -B 100 "$UDID" | grep "-- iOS" | tail -1 | sed 's/.*iOS \([0-9.]*\).*/\1/')
          echo "SIMULATOR_UDID=$UDID" >> $GITHUB_ENV
          echo "DEVICE_NAME=$DEVICE" >> $GITHUB_ENV
          echo "PLATFORM_VERSION=$VERSION" >> $GITHUB_ENV
      - name: Pre-install App
        run: xcrun simctl install "${{ env.SIMULATOR_UDID }}" "apps/Z Platform-QA.app"
      - name: Start Appium
        run: |
          appium --relaxed-security --log-level info --port 4723 > appium.log 2>&1 &
          for i in $(seq 1 ${{ env.APPIUM_MAX_RETRIES }}); do
            curl -s http://127.0.0.1:4723/status 2>/dev/null | grep -q "ready" && exit 0
            sleep 2
          done
          cat appium.log | tail -30 && exit 1
      - name: Run Tests
        continue-on-error: true
        run: |
          mvn test -DsuiteXmlFile=src/test/resources/parallel-quick/testng-phase4-quick.xml \
            -DDEVICE_NAME="${{ env.DEVICE_NAME }}" \
            -DPLATFORM_VERSION="${{ env.PLATFORM_VERSION }}" \
            -DSIMULATOR_UDID="${{ env.SIMULATOR_UDID }}" \
            -DAPP_PATH="${{ github.workspace }}/apps/Z Platform-QA.app"
      - name: Upload Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: phase4-quick-report
          path: |
            target/surefire-reports/
            reports/
            screenshots/
          retention-days: 3
          if-no-files-found: warn

  phase5-quick:
    runs-on: macos-15
    timeout-minutes: 30
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          distribution: 'temurin'
          java-version: '17'
      - uses: actions/setup-node@v4
        with:
          node-version: '18'
      - name: Install Appium
        run: |
          npm install -g appium@2.5.0
          appium driver install xcuitest@7.9.1
      - name: Unzip App
        run: unzip -o apps/Z-Platform-QA.zip -d apps/
      - name: Boot Simulator
        run: |
          UDID=$(xcrun simctl list devices available | grep -E "iPhone 16 Pro" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && UDID=$(xcrun simctl list devices available | grep -E "iPhone 1[456]" | head -1 | awk -F '[()]' '{print $2}')
          [ -z "$UDID" ] && exit 1
          xcrun simctl boot "$UDID" 2>/dev/null || true
          sleep ${{ env.SIMULATOR_BOOT_WAIT }}
          DEVICE=$(xcrun simctl list devices | grep "$UDID" | sed 's/ (.*//g' | xargs)
          VERSION=$(xcrun simctl list devices | grep -B 100 "$UDID" | grep "-- iOS" | tail -1 | sed 's/.*iOS \([0-9.]*\).*/\1/')
          echo "SIMULATOR_UDID=$UDID" >> $GITHUB_ENV
          echo "DEVICE_NAME=$DEVICE" >> $GITHUB_ENV
          echo "PLATFORM_VERSION=$VERSION" >> $GITHUB_ENV
      - name: Pre-install App
        run: xcrun simctl install "${{ env.SIMULATOR_UDID }}" "apps/Z Platform-QA.app"
      - name: Start Appium
        run: |
          appium --relaxed-security --log-level info --port 4723 > appium.log 2>&1 &
          for i in $(seq 1 ${{ env.APPIUM_MAX_RETRIES }}); do
            curl -s http://127.0.0.1:4723/status 2>/dev/null | grep -q "ready" && exit 0
            sleep 2
          done
          cat appium.log | tail -30 && exit 1
      - name: Run Tests
        continue-on-error: true
        run: |
          mvn test -DsuiteXmlFile=src/test/resources/parallel-quick/testng-phase5-quick.xml \
            -DDEVICE_NAME="${{ env.DEVICE_NAME }}" \
            -DPLATFORM_VERSION="${{ env.PLATFORM_VERSION }}" \
            -DSIMULATOR_UDID="${{ env.SIMULATOR_UDID }}" \
            -DAPP_PATH="${{ github.workspace }}/apps/Z Platform-QA.app"
      - name: Upload Report
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: phase5-quick-report
          path: |
            target/surefire-reports/
            reports/
            screenshots/
          retention-days: 3
          if-no-files-found: warn

  send-email:
    needs: [auth-quick, site-quick, phase1-quick, phase2-quick, phase3-quick, phase4-quick, phase5-quick]
    if: always()
    runs-on: ubuntu-latest
    timeout-minutes: 15
    steps:
      - name: Download All Reports
        uses: actions/download-artifact@v4
        with:
          path: all-reports
        continue-on-error: true

      - name: Check Reports
        run: |
          echo "=== Downloaded Reports ==="
          ls -laR all-reports/ 2>/dev/null | head -50 || echo "No reports"

      - name: Prepare Email
        id: email
        run: |
          AUTH="${{ needs.auth-quick.result }}"
          SITE="${{ needs.site-quick.result }}"
          P1="${{ needs.phase1-quick.result }}"
          P2="${{ needs.phase2-quick.result }}"
          P3="${{ needs.phase3-quick.result }}"
          P4="${{ needs.phase4-quick.result }}"
          P5="${{ needs.phase5-quick.result }}"
          
          SUCCESS=0
          [ "$AUTH" = "success" ] && SUCCESS=$((SUCCESS+1))
          [ "$SITE" = "success" ] && SUCCESS=$((SUCCESS+1))
          [ "$P1" = "success" ] && SUCCESS=$((SUCCESS+1))
          [ "$P2" = "success" ] && SUCCESS=$((SUCCESS+1))
          [ "$P3" = "success" ] && SUCCESS=$((SUCCESS+1))
          [ "$P4" = "success" ] && SUCCESS=$((SUCCESS+1))
          [ "$P5" = "success" ] && SUCCESS=$((SUCCESS+1))
          
          FAILED=$((7-SUCCESS))
          echo "SUCCESS=$SUCCESS" >> $GITHUB_OUTPUT
          echo "FAILED=$FAILED" >> $GITHUB_OUTPUT
          
          # Simple text-based email body
          cat > email_body.html << EOF
          <h1>iOS Quick Verification Results</h1>
          <p><strong>Branch:</strong> ${{ github.ref_name }}</p>
          <p><strong>Commit:</strong> ${{ github.sha }}</p>
          <p><strong>Run:</strong> <a href="${{ github.server_url }}/${{ github.repository }}/actions/runs/${{ github.run_id }}">View Details</a></p>
          <hr>
          <h2>Results: ${SUCCESS}/7 Passed</h2>
          <table border="1" cellpadding="8">
            <tr><th>Job</th><th>Status</th></tr>
            <tr><td>Auth</td><td>${AUTH}</td></tr>
            <tr><td>Site</td><td>${SITE}</td></tr>
            <tr><td>Phase 1</td><td>${P1}</td></tr>
            <tr><td>Phase 2</td><td>${P2}</td></tr>
            <tr><td>Phase 3</td><td>${P3}</td></tr>
            <tr><td>Phase 4</td><td>${P4}</td></tr>
            <tr><td>Phase 5</td><td>${P5}</td></tr>
          </table>
          <hr>
          <p>Passed: ${SUCCESS} | Failed: ${FAILED}</p>
          EOF

      - name: Collect Files
        run: |
          mkdir -p attachments
          find all-reports -name "*.html" -type f -exec cp {} attachments/ \; 2>/dev/null || true
          ls -la attachments/ 2>/dev/null || echo "No attachments"

      - name: Send Email
        if: github.event.inputs.send_email != 'false'
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com
          server_port: 587
          username: ${{ secrets.EMAIL_USERNAME }}
          password: ${{ secrets.EMAIL_PASSWORD }}
          subject: iOS Quick Verification - ${{ steps.email.outputs.SUCCESS }}/7 Passed
          html_body: file://email_body.html
          to: ${{ secrets.EMAIL_TO }}
          from: iOS Automation <${{ secrets.EMAIL_USERNAME }}>
        continue-on-error: true

      - name: Summary
        run: |
          echo "========================================"
          echo "QUICK VERIFICATION COMPLETE"
          echo "========================================"
          echo "Passed: ${{ steps.email.outputs.SUCCESS }}/7"
          echo "Failed: ${{ steps.email.outputs.FAILED }}/7"
          echo "========================================"
